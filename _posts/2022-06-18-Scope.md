---
title: "[오늘의 배움] Scope"
excerpt: "Scope에 대해 알아보자"

categories:
  - Javascript
tags:
  - [오늘의배움, Javascript]

toc: true
toc_sticky: true

date : 2022-06-18
last_modified_at : 2022-06-18
---

오늘은 Scope 이라는 것에 대해서 알아보도록 하자.

> Scope(스코프) 란?

Scope는 범위라는 뜻을 가지고 있다. 즉 스코프라는 것은 변수에 접근(참조)을 할 수 있는 범위라고 생각하면 될 것 같다.

ES6 부터 나온 let과 const 그리고 var 키워드로 선언한 변수의 스코프는 다르게 동작하기 때문에 잘 알아두는 것이 좋을 것 같다.

바로 예제 코드로 알아 보자

예제 코드 👇

```javascript
var a = 1;

if(true){
    var b = 1;
    if(true){
        var c = 1;
    }
}

function test(){
    var d = 1;
    function test2(){
        var e = 1;
    }
}

console.log(a); // result : 1
console.log(b); // result : 1
console.log(c); // result : 1
console.log(d); // result : ReferenceError .. 
console.log(e); // result : ReferenceError ..
```

위와 같이 모든 식별자들은 선언된 위치에 의해 다른 코드가 자신을 참조할 수 있는 범위가 결정된다.

다음은 스코프의 종류에 대해서 알아보자.

> 스코프의 종류

스코프의 종류로는 지역과 전역이 있다.

전역스코프는 말 그대로 전역에서 접근(참조)이 가능한 스코프이고 지역 스코프는 함수 내부에서 접근이 가능한 스코프이다.

말로만 하면 이해가 잘 되지 않을 수도 있으니 바로 예제 코드로 봐보자

예제 코드 👇

```javascript
var a = 1;  // 이것이 전역에 선언된 변수이다.

function test(){
    var b = 1; // 이것이 지역에 선언된 변수이다.
}

console.log(a); // result : 1 전역에 선언된 변수는 접근(참조)가 가능해서 1이라는 결과가 잘 나온다.
console.log(b); // ReferenceError: b is not defined 지역에 선언된 변수는 접근(참조)이 불가능 해서 에러가 뜬다 !!
```

또 다른 예제 코드도 보자 !!

예제 코드 👇

```javascript
var a = 1;

function test(){
    console.log(a); 
}

test();
```

이렇게 선언해서 test 함수를 실행해보면 어떤 결과가 나올까??

결과는 1로 a의 값이 잘 나온다 😱

아까 말했듯이 전역 스코프에 선언된 변수는 어디서든지 접근(참조)가 가능해서 값이 잘 나오는 것이다.

하지만 아까처럼 함수 내부에 선언된 변수는 지역 변수로 전역에서는 참조가 되지 않는 것이였다.

그럼 함수 내부에 또 다른 함수를 선언하고 그 안에 변수를 선언한 것은 어떻게 될까??

예제 코드로 알아보자

예제 코드 👇

```javascript
var a = 1;

function test(){
    var b = 1;

    test2();
    function test2(){
        console.log(b); // result : 1
    }
}

test();
```

결과와 같이 변수 b의 값인 1이 결과로 잘 나온다.

즉 지역 변수는 자신의 지역 스코프 또는 하위 지역 스코프에서 접근(참조)가 가능하다는 것이다 !!!!!!

그래서 맨 처음 예제 코드에서 변수 d와 e는 자신의 스코프의 상위 스코프인 전역에서는 접근(참조)가 되지 않아 ReferenceError가 결과로 나왔던 것이다.

자바스크립트는 어떻게 이렇게 접근(참조)가 가능한 것일까????

그건 자바스크립트 엔진이 __스코프체인__ 이라는 것을 통해 참조할 변수를 검색했기 때문이다.(ㄱ..그만 🤮)

> 스코프 체인

그럼 스코프 체인이라는게 뭘까...

위 예제 코드를 보면 함수안에 함수가 있는 걸 볼 수가 있다.

이것을 __중첩 함수__ 라고 하는데 정확하게는 test2 함수가 중첩 함수이고, 중첩 함수를 포함하는 함수인 test 함수가 __외부 함수__ 라고 한다.

이 말은 스코프가 함수의 중첩에 의해 계층적 구조를 갖는 다는 의미이다.

다시 한번 예제 코드로 봐보자.

예제 코드 👇

```javascript
var a = 1;

function test(){
    var b = 1;

    test2();
    function test2(){
        console.log(b); // result : 1
        var c = 1;
    }
}

test();
```

중첩 함수인 test2에 c라는 변수를 추가해 보았다.

그럼 연결은 어떻게 되냐 !? 바로 아래와 같이 된다. (이게 최선,,,,,)

|전역 스코프||
|------|---|
|변수 a | 값 : 1|

        ☝

|test 지역 스코프||
|------|---|
|변수 b | 값 : 1|

        ☝

|test2 지역 스코프||
|------|---|
|변수 c | 값 : 1|

이것이 아까 말한 계층적 구조를 말하고, 검색 또한 이 순서대로 하는데 참조하려는 코드의 스코프에서 시작해서 상위 스코프 방향으로 이동하면서 검색을 한다. 이것 때문에 test2에서 상위 스코프인 test의 변수 b를 접근(참조)하려고 해도 ReferenceError가 나오지 않았던 이유이다.

test2 지역스코프에서 변수 b 검색 -> 없네?? 상위 스코프인 test의 지역 스코프로 이동 -> 변수 b 발견 -> 출력

주의 ❗ 상위 스코프에서 하위스코프로 이동해 검색하지 않는다.(접근, 참조 불가능 !!)

> 함수 레벨 스코프

맨 처음에 var과 let, const의 스코프가 다르게 동작한다고 했는데 지금 한 번 알아보자

익숙한 자바에서는 함수 뿐만 아니라 모든 코드 블록에서 지역 스코프를 만든다.

이것을 __블록 레벨 스코프__ 라고 한다. 하지만 우리 자바스크립트의 var는 다르다.. 바로 예제 코드로 확인해보자.

예제 코드 👇

```javascript
var i = 1;

for(var i = 0; i<5; i++){
    ...
}

console.log(i);
```

이렇게 선언하면 다른 언어에서는 결과가 1이 나오지만 var로 선언한 자바스크립트에서는 2가 출력이 된다.

왜 그러냐 ?!!?!?!? 

var로 선언된 변수는 __함수__ 만 지역 스코프로 만든다. 예제 코드에 for문은 함수가 아니기 때문에 전역 변수가 되어 버린 것이다. 

설명은 for문만 했지만 if, for, while, try/catch 등도 전역 변수로 만든다.

즉 함수를 제외한 것들은 다 전역변수로 만든다고 알아두면 될 것 같다.

이것을 __함수 레벨 스코프__ 라고 한다. 아까 말한 __블록 레벨 스코프__ 와 다른 개념이다 !

이러한 것 때문에 __블록 레벨 스코프__ 를 지원하는 let과 const가 ES6부터 도입 되었다.

오늘은 스코프에 대해서 알아봤다,, 뭔가 주절주절 쓴 것 같은데 나중에 내가 봐도 알아볼지 모르겠다 😅😅

```참조 : 모던 자바스크립트 Deep Dive / MDN```


